<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brains@Play Docs</title>
    <link rel=stylesheet href="../../../../.docs/default.css"/>
    <link rel=stylesheet href="../../../../static/custom.css"/>
    <link rel="icon" href="../../../../static/img/favicon.ico" type="image/x-icon" />
</head>
<body>
    <header>
        <nav><h1>Brains@Play</h1></nav>
    </header>
    <section>
        <h1 id="cmdservice">CMDService</h1>
<p>The CMD service lets you command child processes in Node.js (using the <code>graphscript-node</code> dist). It's a pretty straightforward process,<br />
 you provide routes with commands and arguments as they fit into normal child process callbacks. </p>
<p>See <code>services/cmd/childproces.js</code> for a boilerplate node process you can run that sets up a CMDService to enable cross-process message passing by listening to process.stdin the same way other message passing services listen, including all of the helpful utilities like running functions or subscribing across processes.</p>
<div class="brainsatplay-docs-code"><span>Code</span>
<pre><code>
type CMDRoute = {
    command:string|ChildProcess,
    args?:string[],
    options?:{shell:true, stdio:'inherit',[key:string]:any},
    env?:any,
    cwd?:any,
    signal?:any,
    stdout?:(data:any)=&gt;void,
    onerror?:(error:Error)=&gt;void,
    onclose?:(code: number | null, signal: NodeJS.Signals | null)=&gt;void
} &amp; GraphNodeProperties

type CMDInfo = {
    process:ChildProcess,
    _id:string,
    controller:AbortController,
    send:(data:Serializable)=&gt;boolean,
    request:(message:ServiceMessage|any, method?:string) =&gt; Promise&lt;any&gt;,
    post:(route:string, args:any, method?:string) =&gt; boolean,
    run:(route:any, args?:any, method?:string) =&gt; Promise&lt;any&gt;,
    subscribe:(route:any, callback?:((res:any)=&gt;void)|string) =&gt; number,
    unsubscribe:(route:any, sub:number) =&gt; Promise&lt;boolean&gt;
} &amp; CMDRoute


import { CMDService } from "./CMD.node";
import { unsafeRoutes } from '../unsafe/Unsafe.service';

const service = new CMDService({
    routes:[unsafeRoutes]
}); //now we can send/receive messages

console.log("Child process listening...") 

 //....

</code></pre></div>
<p>Then create childprocess.js in your root (for this example)</p>
<div class="brainsatplay-docs-code"><span>Code</span>
<pre><code>
import { CMDService } from "./CMD.node";
import { unsafeRoutes } from '../unsafe/Unsafe.service';

const service = new CMDService({
    routes:[unsafeRoutes]
}); //now we can send/receive messages

console.log("Child process listening...") 


</code></pre></div>
<p>and from your main program, add the following after instantiating a CMDService</p>
<div class="brainsatplay-docs-code"><span>Code</span>
<pre><code>
//....


const p = service.createProcess({
    command:'node',
    args:['childprocess.js']
});

</code></pre></div>
<p>and now you can interact with it nodes across child processes!</p>
    </section>
    <footer></footer>
</body>
</html>
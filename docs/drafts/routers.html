<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brains@Play Docs</title>
    <link rel=stylesheet href="../.docs/default.css"/>
    <link rel=stylesheet href="../static/custom.css"/>
    <link rel="icon" href="../static/img/favicon.ico" type="image/x-icon" />
</head>
<body>
    <nav></nav>
    <h1 id="gettingstartedwithrouters">Getting Started with Routers</h1>
<p><code>brainsatplay-frontend</code> and <code>brainsatplay-backend</code> provide default communication services including HTTPService and WebsocketService.</p>
<h2 id="loadingfrontendservices">Loading Frontend Services</h2>
<p>In your frontend code, load specify the Sockets your Router will listen to:</p>
<pre><code class="js language-js">const SERVER_URI = (window.location.href.includes('localhost')) ? 'http://localhost:80' : 'http://localhost:80' // Replace with production server URI
const SERVER_URI_2 = (window.location.href.includes('localhost')) ? 'http://localhost:81' : 'http://localhost:81' // Replace with production server URI

const sockets = []
sockets.push(router.addSocket(SERVER_URI))
sockets.push(router.addSocket(SERVER_URI_2))
</code></pre>
<p>Then load any services you'll want the Router to use:</p>
<pre><code class="js language-js">import {WebsocketService} from 'brainsatplay-frontend' // TODO: Publish and change name

let services = [ 
    new HTTPService(), 
    new WebsocketService(), 
]

services.forEach(service =&gt; router.load(service).then(() =&gt; console.log('Service connected!', service)))
</code></pre>
<p>At this point, your project should be able to send HTTP and WebSocket messages to supported servers.</p>
<blockquote>
  <p><strong>Note:</strong> Services can be strongly or weakly linked to FE / BE. Weakly linked Services can run on either FE or BE. For this case, specify backend methods with an underscore (e.g. _backendMethod) so that all frontend methods are easily referenced by an end-user.</p>
</blockquote>
<h2 id="addingthebackend">Adding the Backend</h2>
<p>In your backend code, create an Express application and link this to your Router with an HTTP Service. Here we will instantiate the Router class ourselves to enable auto-debugging:</p>
<pre><code class="js language-js">// Express Imports
let express = require("express")
let bodyParser = require("body-parser")

// Router Imports
import { Router } from 'brainsatplay'
import {HTTPService, WebsocketService} from 'brainsatplay-backend'

// Create Express App
const app = express();
app.use(bodyParser.json());

// Create HTTP Server
let protocol = "http";
const port = '80';
const server = http.createServer(app);

// Create a Router
let router = new Router({ debug: true });

// Handle All HTTP Routes
let http = new HTTPService();
app.get("**", http.controller);
app.post("**", http.controller);
app.delete("**", http.controller);
router.load(http);

// Handle WebSocket Messages
let websocket = new WebsocketService(server);
router.load(websocket)

// Start the Server
server.listen(parseInt(port), () =&gt; {
  console.log(`Server created on ${protocol}://localhost:${port}`);
});
</code></pre>
    <footer></footer>
</body>
</html>